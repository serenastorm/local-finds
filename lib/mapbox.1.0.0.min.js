mapboxgl.accessToken="pk.eyJ1IjoiYnlhbmltYSIsImEiOiJjbGt3eTQxMXUwNXlrM3FueTVkYTUyZmwwIn0.ZUthdqyjpaM2LxlZtUfSaw";var active_popup,active_marker,active_item,map=new mapboxgl.Map({container:"map",style:"mapbox://styles/byanima/clkx0n1rk005z01qsdmyd9v0l",center:[-3.1910909,55.9519327],zoom:12.5});map.addControl(new mapboxgl.NavigationControl);var renderLocationOnMap=function(){var e=this;console.log("renderLocation",this);var t=this,o=t.find(".lat").text(),a=t.find(".lon").text(),n=this.popup,i=document.createElement("div"),r=t.find(".location-category").text();i.classList.add("marker"),i.classList.add("marker-".concat(r.toLowerCase()));var c=t.find(".pre-popup")[0].outerHTML;n=new mapboxgl.Popup({offset:25,closeButton:!1,maxWidth:"auto"}).setHTML(c);this.marker;new mapboxgl.Marker(i).setLngLat([a,o]).setPopup(n).addTo(map);var l=function(t){null!=active_marker&&(active_item.classList.remove("active"),active_popup.remove()),n.addTo(map),active_popup=n,active_marker=i,(active_item=e).classList.add("active"),map.flyTo({center:[a,o],essential:!0,zoom:map.getZoom()}),t&&active_item.scrollIntoViewIfNeeded({behavior:"smooth",block:"nearest",inline:"start"})};i.addEventListener("click",(function(){l(!0)})),this.addEventListener("click",(function(){l()})),n.on("close",(function(){active_item.classList.remove("active"),active_marker=void 0}))};window.onload=function(){document.querySelectorAll(".location").forEach((function(e){renderLocationOnMap.call(e)}));var e=new MutationObserver((function(e){for(var t=0,o=e;t<o.length;t++){var a=o[t];if("childList"===a.type){console.log("A child node has been added or removed.");var n=Array.prototype.slice.call(a.addedNodes),i=Array.prototype.slice.call(a.removedNodes);n.forEach((function(e){console.log("Parent added node",e.parentElement),e.parentElement.classList.contains("list-item")&&(console.log("Added node",e),renderLocationOnMap.call(e))})),i.forEach((function(e){console.log("Parent removed node",e.parentElement),e.parentElement.classList.contains("list-item")&&(console.log("Removed node",e),e.marker.remove())}))}}})),t=document.getElementById("list-wrapper");e.observe(t,{childList:!0})};